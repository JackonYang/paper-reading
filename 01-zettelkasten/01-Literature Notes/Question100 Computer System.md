# 计算机系统 100 问

Created: 2022-05-08 09:31

Scope：硬件（含 GPU，ARM）、OS & 编译器

## CPU & 指令集

1. 什么是计算机流水线？-- 指令处理过程拆分为多个步骤，每个时钟周期都发射一条指令，pipeline 执行，提高吞吐率。
2. 什么是 SIMD? -- Single Instruction Multiple Data 单指令流多数据流。需要并行寄存器。TODO
4. 什么是超标量(super scalar)？-- 即 MIMD 模式。CPU中有一条以上的流水线，一个时钟周期发射多条指令。
5. 什么是乱序执行(out of order)? -- 流水线执行时，为了优化吞吐率，会调整指令执行顺序。TODO
6. 什么是 prefetch？-- 指令预取到 L1 指令集 cache 中，比起访问主存要快。是否会用 TLB TODO
7. 为什么需要分支预测？-- 增强指令运的的连续性，减少流水线停顿
8. 哪些分支预测，提升准确率比较难？-- 条件分支预测，比如 if else, for-loop
9. 条件分支预测的的手段有哪些？-- 静态预测，编译时执行。动态预测，使用分支历史表。2 位预测机制，预测错 2 次，反转 cache。4k 的缓冲区，SPEC89 的最终错误率 1-18%
10. 数据冒险的消除方法有哪些？-- 在硬件层面做了，程序员一般不用关心。2 个方法：转发，加硬件，把输出直接写入流水线寄存器。流水线互锁，解决 load/use hazard。
11. 为什么循环展开可以作为一种常见的优化手段？需要注意什么？-- 减少了分支预测，有利于流水线执行。TODO
12. 什么是 CPI 或者 IPC？影响指标的因素是什么？-- cycle per instruction。硬件层面一般用 CPI。软件优化时用 IPC。主要是各种 hazard
13. 如何测 CPI -- perf stat
15. 给定一款 CPU，比如 ARM Cortex-A72，假设只能运行在 1.6GHz，其峰值计算能力是多少？怎么计算？-- 频率 * 核心数 * CPI * 并行计算的 bit 数。TODO
16. linpack 是什么 ？-- TODO

## GPU

1. CUDA 与 OpenCL 的区别，用哪个？-- TODO
2. Tesla P4 的标称 FLOPS 为 5.5TFLOPS，该数据是怎么来的？-- TODO
3. NVIDIA GPU 计算和存储分为哪几层？怎么和 CUDA 对应？-- 分为一个任务控制核心和很多流控制器，每个流处理器有自己的1级缓存，和共用的2级缓存 TODO

## 内存 & Cache

1. 为什么需要缓存？-- 访问内存太慢。有效地将内存移到更靠近处理器的地方
2. 为什么设计 L1 / L2 / L3 三级缓存？-- 访问内存的 latency 太高。越快的 cache，成本越高。3 级设计，在降低 latency 和成本之间平衡。
3. 什么是组相联、全相联、直接映射，优缺点？-- 直接映射是一一对应，比较容易找到，但是耗费太高；全相联是每个内存都能对应到一个缓存，效率太低；组相联就是分组映射，折中效果。TODO
4. 什么是 Cache line，Cache line对于内存访问的影响是什么？-- 缓存不命中时，会写入这条数据及其前后的一组数据，而不是只 cache 当前数据。在局部性友好的代码里，后续数据访问的命中率会明显提升。
5. 怎么看机器上 cache line 的大小。-- getconf -a | grep CACHE
7. Cache Trash 是什么，如何避免？cache 颠簸。同时循环访问 2 个变量 x 和 y，二者映射到相同的 cache 组，缓存冲突，反复相互覆盖导致命中率很低。数组长度加填充，避免使用 2 的幂次方。
8. 什么是 cache coherence？-- 缓存一致性，多芯片下比较难处理。例，多 CPU 的架构中，L1 cache 不共享，其中一个 CPU 写数据时，另一个 CPU 读取的数据可能不一致。需要一些同步机制。通常，处理器都实现了 Cache 一致性 (Cache Coherence）协议
9. 什么是 NUMA 架构？-- 多个 CPU 的系统中，每个 CPU 有本地内存。TODO
10. NUMA 架构下对于性能计算加速的影响？-- TODO
11. Cache Line 伪共享问题？-- NUMA 架构下发生。由多个 CPU 上的多个线程同时修改自己的变量引发的。表面上是不同的变量，但是实际上却存储在同一条 Cache Line 里。
12. 什么是虚拟内存？TLB的作用是什么？-- TODO
13. 什么是 page fault？-- 虚拟地址找物理地址，但是访问不了 TODO
14. 哪些情况会导致 page fault？-- 1. 访问权限不够，2. 映射关系没建立， 3. 页面在交换空间中等 TODO

## OS

TODO

## 编译器

1. 什么是 intrinsic？-- 编译器内在函数，介于汇编 & c 语言之间，提供更高的速度和处理器功能。与特定指令共享一对一或多对一关系。 这允许使用高级编程构造来编写特定指令，并使开发人员不必担心调用约定，寄存器分配和指令调度。

## 平台相关

### Intel

1. Intel 近年来的架构都有什么，为了提高计算能力，都有哪些改进？-- haswell, skylake, icelake TODO
2. SSE、AVX、AVX2 指令集？-- TODO

### ARM

1. NEON 指令集？-- TODO
2. 简述 ARM-v7 和 ARM-v8 的区别？-- TODO

## References

1.
